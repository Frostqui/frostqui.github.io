<!DOCTYPE html>

<html lang="">

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-7551074192374685",
    enable_page_level_ads: true
  });
</script>

<link rel="shortcut icon" type="image/png" href="/images/favicon.png" />

<link href="https://fonts.googleapis.com/css?family=Lato|Titillium+Web" rel="stylesheet">

<link href="/css/prism.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/ficons@1.1.52/dist/ficons/font.css" rel="stylesheet">
<link rel="stylesheet" href="/css/picnic.min.css">
<link rel="stylesheet" href="/css/index.css">


  <title>Bot de Telegram con PHP</title>
  <meta name="twitter:title" content="Bot de Telegram con PHP">


<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@Frostq_">
<meta property="og:site_name" content="Frostq - Coding beers">
<meta property="article:author" content="Diego López García (Frostq)">


  <meta name="twitter:description" content="Cómo crear un bot en Telegram usando PHP y Heroku. Tutorial básico en español.">
  <meta name="description" content="Cómo crear un bot en Telegram usando PHP y Heroku. Tutorial básico en español.">
  <meta property='og:description' content="Cómo crear un bot en Telegram usando PHP y Heroku. Tutorial básico en español." />


<meta name="theme-color" content="#9c95ed">



  
    <meta name="twitter:image:src" content="http://localhost:4000/images/posts/telegram.jpg">
    <meta property='og:image' content="http://localhost:4000/images/posts/telegram.jpg" />
    



  <meta name="twitter:url" content="http://localhost:4000/bot_telegram_php">
  <meta property='og:url' content="http://localhost:4000/bot_telegram_php" />
 

<script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-87066592-1', 'auto');
    ga('send', 'pageview');
</script>



</head>


<body>

  
  
<nav class="nav_transparent">
    <a href="/" class="brand">
      <img class="navbar_logo" src="/images/logo_horizontal.png"  />
      
    </a>
  
    <!-- responsive-->
    <input id="bmenub" type="checkbox" class="show">
    <label for="bmenub" class="burger pseudo button"><i class="fa fa-bars"></i></label>
  
    <div class="menu">
      <ul>
        <a href="/blog">
          <li id="header_item">BLOG</li>
        </a>
        <a href="/projects">
          <li id="header_item">PROJECTS</li>
        </a>
        <a href="/about">
          <li id="header_item">ABOUT ME</li>
        </a>
        <a href="/feed.xml">
          <li id="header_item">RSS</li>
        </a>
    
      </ul>
    </div>
  </nav>


<div class="post_header" style="background-image: linear-gradient( rgba(23, 45, 65, 0.5), rgba(54, 75, 94, 0.9) ), url(/images/posts/telegram.jpg)">
  <div class="container post_header_content">
    <h1 class="post_title">Bot en Telegram con PHP </h1>


    <div class="post_date">April 17, 2016</div>

    <div class="post_tags">
      

      <a class="tags" href="/tag#php">PHP</a>

      

      <a class="tags" href="/tag#telegram">Telegram</a>

      

      <a class="tags" href="/tag#heroku">Heroku</a>

      
    </div>

    

    <div class="post_read_time">
      
        <i class="fa fa-clock-o"></i> 4 min read 
    </div>

  </div>
</div>


<div class="container">


  <div align="center">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- Ad -->
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7551074192374685" data-ad-slot="4480248215" data-ad-format="auto"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>

  <div class="post_content">
    <p>Telegrames una aplicación de mensajeria open source. Entre otras cosas, permite la creación de bots que pueden ejecutar ciertas acciones. En este tutorial aprenderemos a crear un bot con <b>PHP</b> usando la plataforma cloud de <b>Heroku</b></p>

<p>Lo primero que tenemos que hacer es dirigirnos a Telegram e iniciar una conversación con un @BotFather, un bot creado para crear y administrar bots.
https://telegram.me/botfather
A continuación escribimos<b> /newbot</b> y escribimos el nombre del bot. Otros comandos de utilidad son los siguientes:</p>

<ul>
<li><b>/token</b> - Genera el token de autorización.</li>
<li><b>/setname</b> - Para cambiar el nombre del bot.</li>
<li><b>/setdescription</b> - Cambia la descripcion del bot.</li>
<li><b>/setuserpic</b> - Cambia la foto de perfil del bot</li>
<li><b>/setcommands</b> - Puedes incluir comandos para el bot.</li>
<li><b>/setjoingroups</b> - Puedes permitir que el bot pueda ser añadido a grupos.</li>
<li><b>/deletebot</b> - Elimina el bot.</li>
</ul>

<p>Una vez creado el bot en Telegram, tenemos que generar nuestro token de acceso, escribiendo el comando <em>/token.</em></p>

<p>El siguiente paso es registrarnos en la plataforma cloud que vamos a utilizar para alojar nuestro codigo PHP encargado de hacer funcionar nuestro bot en Telegram, en nuestro caso Heroku <a href="https://dashboard.heroku.com/new">https://dashboard.heroku.com/new</a>
Creamos una app en heroku y buscamos en la pestaña de Settings el nombre del dominio que nos han asignado.</p>

<p>Ahora tenemos que añadir el webhook de nuestra app de heroku a nuestro bot de telegram para que tenga permisos. Para ello nos dirigimos a este enlace:</p>

<p>https://api.telegram.org/bot[TOKEN]/setWebhook?url=[URL]</p>

<p>Y cambiamos [TOKEN] por el token que generamos con BotFather y [URL] por la URL que nos asignaron en Heroku. Si todo ha ido bien debería aparecer un mensaje de OK.</p>

<p>Ahora toca empezar con la programación de nuestro bot en si con PHP. Para ello nos descargamos este repositorio de git: <a href="https://github.com/kasramp/geekswebbot">https://github.com/kasramp/geekswebbot </a>haciendo clic en Download Zip o con el comando <em>git clone</em>.
Abrimos el archivo index.php que hemos descargado y lo abrimos con SublimeText, o cualquier otro editor de código, y cambiamos la linea que dice:
<em>$client = new Zelenin\Telegram\Bot\Api(‘’); // Set your access token</em>
Tenemos que poner entre las comillas nuestro token que generó BotFather.
A continuación podemos cambiar los comandos que vienen por defecto mas abajo con lo que queramos que haga nuestro bot. Por ejemplo yo he cambiado el comando:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="nv">$update</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">message</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">text</span> <span class="o">==</span> <span class="s1">'/email'</span><span class="p">)</span>
<span class="p">{</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">sendChatAction</span><span class="p">([</span><span class="s1">'chat_id'</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$update</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">message</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">chat</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">id</span><span class="p">,</span> <span class="s1">'action'</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">'typing'</span><span class="p">]);</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">sendMessage</span><span class="p">([</span>
<span class="s1">'chat_id'</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$update</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">message</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">chat</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">id</span><span class="p">,</span>
<span class="s1">'text'</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s2">"You can send email to : Kasra@madadipouya.com"</span>
<span class="p">]);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="nv">$update</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">message</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">text</span> <span class="o">==</span> <span class="s1">'/fecha'</span><span class="p">)</span>
<span class="p">{</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">sendChatAction</span><span class="p">([</span><span class="s1">'chat_id'</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$update</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">message</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">chat</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">id</span><span class="p">,</span> <span class="s1">'action'</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="s1">'typing'</span><span class="p">]);</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">sendMessage</span><span class="p">([</span>
<span class="s1">'chat_id'</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nv">$update</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">message</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">chat</span><span class="o">-&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">id</span><span class="p">,</span>
<span class="s1">'text'</span> <span class="o">=&amp;</span><span class="nx">gt</span><span class="p">;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'l jS \of F Y'</span><span class="p">)</span>
<span class="p">]);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Una vez cambiado el código a nuestro gusto toca subirlo a Heroku. Para ello tenemos que tener descargado PHP, Composer y el Heroku Toolbet en nuestro equipo, los puedes descargar de aquí:
<a href="http://php.net/">http://php.net/</a>
<a href="https://getcomposer.org/doc/00-intro.md">https://getcomposer.org/doc/00-intro.md</a>
<a href="https://toolbelt.heroku.com/">https://toolbelt.heroku.com/</a></p>

<p>Una vez lo tenemos todo nos dirigimos a la terminal o a la consola de comandos cmd e introducimos este comando:</p>

<p><strong><em>heroku login</em></strong></p>

<p>e introducimos nuestro nombre y contraseña que usamos al registrarnos en Heroku. Navegamos hasta el directorio donde tenemos guardado el código de nuestra aplicación y simplemente ejecutamos el comando:</p>

<p><em><strong>git push heroku master</strong></em></p>

<p>Todo listo, nuestro bot programado en PHP ya funciona, ya solo queda probar que nuestro bot funciona correctamente iniciando una conversación con el y enviándole el comando que hemos creado.</p>


  </div>

  
  <div class="related">
    <h2>Posts recomendados</h2>
    <ul class="related_posts">
      
      
      <li>
        <h5>
          <a href="/introduccion-instalacion-angular" class="related_post">
            Angular - Introducción e instalación

          </a>
        </h5>
      </li>
     
      
      
      <li>
        <h5>
          <a href="/angular-formularios" class="related_post">
            Angular - FormControl y FormGroup para crear formularios reactivos

          </a>
        </h5>
      </li>
     
      
      
      <li>
        <h5>
          <a href="/cuantas-tecnologias-web-existen" class="related_post">
            ¿Cuántas tecnologías para el desarollo web existen?

          </a>
        </h5>
      </li>
     
      
      
      <li>
        <h5>
          <a href="/optimizar-angular" class="related_post">
            Optimizar aplicaciones Angular 2 para aumentar la velocidad de carga

          </a>
        </h5>
      </li>
     
      
    </ul>
  </div>




</div>



<div align="center">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- Ad -->
  <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7551074192374685" data-ad-slot="4480248215" data-ad-format="auto"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>



  <footer>
    <div class="flex three">
        <div class="full half-1000">

            <div id="mc_embed_signup">
                <form action="https://github.us14.list-manage.com/subscribe/post?u=cd16a671a63cd217caf6b2f3f&amp;id=bb3cc69837" method="post"
                    id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
                    <div id="mc_embed_signup_scroll">
                        <h2>Newsletter <i class="fa fa-envelope icon_footer" aria-hidden="true"></i></h2>
                        <p>Sigue el blog por email. Introduce tu dirección de correo electrónico para que te mande un correo
                            cuando publique un nuevo artículo en este blog</p>

                        <div class="mc-field-group">
                            <label for="mce-EMAIL">Tu email
                                <span class="asterisk">*</span>
                            </label>
                            <input type="email" style="color:black;" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Introduce tu correo electrónico">
                        </div>
                        <div id="mce-responses" class="clear">
                            <div class="response" id="mce-error-response" style="display:none"></div>
                            <div class="response" id="mce-success-response" style="display:none"></div>
                        </div>
                        <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                        <div style="position: absolute; left: -5000px;" aria-hidden="true">
                            <input type="text" name="b_cd16a671a63cd217caf6b2f3f_bb3cc69837" tabindex="-1" value="">
                        </div>
                        <div class="clear">
                            <input type="submit" value="Suscribirse por email" name="subscribe" id="mc-embedded-subscribe" class="button footer_button">
                        </div>
                    </div>
                </form>
            </div>

            <!--End mc_embed_signup-->

        </div>
        <div class="full sixth-1000">
          
              
                <ul id="footer_menu">
                   
                    <a href="/blog">
                        <li><h4>Blog</h4></li>
                    </a>
                    <a href="/projects">
                        <li><h4></h>Projects</h4></li>
                    </a>
                    <a href="/about">
                        <li><h4>About me<h4></li>
                    </a>
                    <a href="/feed.xml">
                        <li><h4>Rss</h4></li>
                    </a>

                </ul>
           
        </div>
        <div class="full third-1000">
            <ul class="footer_posts">
                    

                    
                   
                    

                    
                    <a href="/introduccion-instalacion-angular"><li><h4>Angular - Introducción e instalación</h4></li></a>
                    
                    
                    
                   
                    

                    
                    <a href="/angular-formularios"><li><h4>Angular - FormControl y FormGroup para crear formularios reactivos</h4></li></a>
                    
                    
                    
                   
                    

                    
                    <a href="/cuantas-tecnologias-web-existen"><li><h4>¿Cuántas tecnologías para el desarollo web existen?</h4></li></a>
                    
                    
                    
                   
                    

                    
                    <a href="/optimizar-angular"><li><h4>Optimizar aplicaciones Angular 2 para aumentar la velocidad de carga</h4></li></a>
                    
                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    

            </ul>
        </div>





    </div>
</footer>




  <script src="/js/prism.js"></script>
  <script src="/js/index.js"></script>



</body>







</html>
