<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-7551074192374685",
    enable_page_level_ads: true
  });
</script>

<link rel="shortcut icon" type="image/png" href="/images/favicon.png" />

<link href="https://fonts.googleapis.com/css?family=Lato|Titillium+Web" rel="stylesheet">

<link href="/css/prism.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/ficons@1.1.52/dist/ficons/font.css" rel="stylesheet">
<link rel="stylesheet" href="/css/picnic.min.css">
<link rel="stylesheet" href="/css/index.css">


  <title>RxJS para programar un widget del tiempo</title>
  <meta name="twitter:title" content="RxJS para programar un widget del tiempo">


<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@Frostq_">
<meta property="og:site_name" content="Frostq - Coding beers">
<meta property="article:author" content="Diego López García (Frostq)">


  <meta name="twitter:description" content="¿Qué es RxJS? ¿Cómo se usa RxJS? ¿Para qué sirve? ¿Cómo podemos usarlo para crear un widget que muestre el tiempo?">
  <meta name="description" content="¿Qué es RxJS? ¿Cómo se usa RxJS? ¿Para qué sirve? ¿Cómo podemos usarlo para crear un widget que muestre el tiempo?">
  <meta property='og:description' content="¿Qué es RxJS? ¿Cómo se usa RxJS? ¿Para qué sirve? ¿Cómo podemos usarlo para crear un widget que muestre el tiempo?" />


<meta name="theme-color" content="#9c95ed">



  
    <meta name="twitter:image:src" content="http://localhost:4000/images/posts/weather.jpg">
    <meta property='og:image' content="http://localhost:4000/images/posts/weather.jpg" />
    



  <meta name="twitter:url" content="http://localhost:4000/widget-tiempo-rxjs">
  <meta property='og:url' content="http://localhost:4000/widget-tiempo-rxjs" />
 

<script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-87066592-1', 'auto');
    ga('send', 'pageview');
</script>



</head>


<body>

  
  
<nav class="nav_transparent">
    <a href="/en/" class="brand">
      <img class="navbar_logo" src="/images/logo_horizontal.png"  />
      
    </a>
  
    <!-- responsive-->
    <input id="bmenub" type="checkbox" class="show">
    <label for="bmenub" class="burger pseudo button"><i class="fa fa-bars"></i></label>
  
    <div class="menu">
      <ul>
        <a href="/en/blog">
          <li id="header_item">BLOG</li>
        </a>
        <a href="/en/projects">
          <li id="header_item">PROJECTS</li>
        </a>
        <a href="/en/about">
          <li id="header_item">ABOUT ME</li>
        </a>
        <a href="/en/feed.xml">
          <li id="header_item">RSS</li>
        </a>
    
      </ul>
    </div>
  </nav>


<div class="post_header" style="background-image: linear-gradient( rgba(23, 45, 65, 0.5), rgba(54, 75, 94, 0.9) ), url(/images/posts/weather.jpg)">
  <div class="container post_header_content">
    <h1 class="post_title">Cómo usar RxJS para crear un widget que muestre el tiempo </h1>


    <div class="post_date">June 02, 2016</div>

    <div class="post_tags">
      

      <a class="tags" href="/tag#rxjs">RxJS</a>

      

      <a class="tags" href="/tag#javascript">Javascript</a>

      

      <a class="tags" href="/tag#html">HTML</a>

      

      <a class="tags" href="/tag#css">CSS</a>

      
    </div>

    

    <div class="post_read_time">
      
        <i class="fa fa-clock-o"></i> 2 min read 
    </div>

  </div>
</div>


<div class="container">


  <div align="center">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- Ad -->
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7551074192374685" data-ad-slot="4480248215" data-ad-format="auto"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>

  <div class="post_content">
    <p><a href="http://codepen.io/Frostq/full/EgEwrN/" class="waves-effect waves-light btn">DEMO</a></p>

<p>Saludos, buen señor. Hoy vamos a aprender a hacer un widget del tiempo usando <strong>RxJS</strong>, pero antes hay que saber que es RxJs y que es la programación reactiva.
RxJs es una librería para JavaScript para la creación de programas asíncronos (No esperamos, el programa no pregunta si una operación en concreto se ha completado, sólo comprueba si ha llegado algún mensaje) basados en eventos.
La programación reactiva es un paradigma de la programación que se basa en los flujos de datos y a la propagación de los datos.
La programación reactiva aprovecha las ventajas del patrón <strong>Iterator</strong> y las ventajas del patrón <strong>Observer</strong>. Es posible escribir sentencias del estilo filtrar, ordenar, seleccionar, etc; sobre eventos.
La diferencia es que la consulta es evaluada conforme llegan los datos. Uno puede evaluar datos en tiempo real.</p>

<p>Bien, vamos a aprovechar las ventajas de la programación reactiva para el desarrollo web.</p>

<h2>Creación del widget</h2>
<p>Para la creación de nuestro widget vamos a utilizar la API de OpenWheaterMap, para ello lo primero que tenemos que hacer es registrarnos en su página oficial:  </p>

<p><a href="http://openweathermap.org/current">http://openweathermap.org/current</a></p>

<p>En la sección API Keys es donde encontraremos nuestra clave para nuestro widget.
Lo primero que tenemos que hacer es añadir la declaración de nuestra API Key y la url de la API, para ello añadimos lo siguiente dentro de la sección <strong>script </strong>de nuestro código html:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const API_KEY = "SUSTITUYE_ESTO_POR_TU_API_KEY";
const API_URL = `http://api.openweathermap.org/data/2.5/weather?appid=${API_KEY}`;
appid=${API_KEY}`;
</code></pre></div></div>

<p>El siguiente paso es seleccionar los dos elementos DOM de nuestro html con los que vamos a interactuar, el texto de la temperatura y el input donde introducimos la localización:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var weatherText = document.querySelector('#weather');
var searchInput = document.querySelector('#location-input');
</code></pre></div></div>

<p>Una vez hecho esto toca recoger la información y mandársela a la API con una petición HTTP, para ello utilizamos una función RxJS llamada <em><strong>Rx.Observable.fromEvent()</strong></em> en conjunción de un <em><strong>debounce</strong></em> de 50mms, que se encargará de registrar un nuevo evento 500ms después del evento anterior. Tras esto mapeamos la información y se la enviamos a la API como sigue:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var searchInputSource = Rx.Observable.fromEvent(searchInput, 'keyup').debounce(500);

var requestOnFindStream = searchInputSource.map(ev =<span class="ni">&amp;gt;</span> {
    return API_URL + "<span class="ni">&amp;amp;</span>q=" + ev.target.value;
});


function convertToCelsius(kelvin) {
 return (kelvin - 273.15).toFixed(1);
}
</code></pre></div></div>

<p>Invocamos la función <em><strong>flatMap() </strong></em>para crear un nuevo stream a partir de una cadena de strings. Por último queda subscribirse al observable y convertir la temperatura a grados Celsius de esta manera:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var responseStream = requestOnFindStream
            .flatMap(requestUrl =<span class="ni">&amp;gt;</span> {
                return Rx.Observable.fromPromise($.getJSON(requestUrl));
            })
            .map(response =<span class="ni">&amp;gt;</span> convertToCelsius(response.main.temp))
            .startWith(0);

responseStream.subscribe(temp =<span class="ni">&amp;gt;</span> {
            weatherText.innerHTML = `${temp} °C`;
  });
</code></pre></div></div>
<p><img class="responsive-img" src="http://i2.wp.com/frostq.ml/wp-content/uploads/2016/05/Screenshot_1.png" alt="ejemplo de rxjs" /></p>

<p>Para terminar puedes consultar la <a href="http://codepen.io/Frostq/full/EgEwrN/"><em><strong>DEMO</strong></em></a> del resultado final.</p>

  </div>

  
  <div class="related">
    <h2>Posts recomendados</h2>
    <ul class="related_posts">
      
       
      
       
      
      
      <li>
        <h5>
          <a href="/en/how-many-web-libraries-are-there" class="related_post">
            How many web frameworks are there?

          </a>
        </h5>
      </li>
       
      
       
      
       
      
    </ul>
  </div>




</div>



<div align="center">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- Ad -->
  <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7551074192374685" data-ad-slot="4480248215" data-ad-format="auto"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>






  <script src="/js/prism.js"></script>
  <script src="/js/index.js"></script>



</body>







</html>
