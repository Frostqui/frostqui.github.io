<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-7551074192374685",
    enable_page_level_ads: true
  });
</script>

<link rel="shortcut icon" type="image/png" href="/images/favicon.png" />

<link href="https://fonts.googleapis.com/css?family=Lato|Titillium+Web" rel="stylesheet">

<link href="/css/prism.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/ficons@1.1.52/dist/ficons/font.css" rel="stylesheet">
<link rel="stylesheet" href="/css/picnic.min.css">
<link rel="stylesheet" href="/css/index.css">


  <title>WebGL y Dart, renderizando figuras simples</title>
  <meta name="twitter:title" content="WebGL y Dart, renderizando figuras simples">


<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@Frostq_">
<meta property="og:site_name" content="Frostq - Coding beers">
<meta property="article:author" content="Diego López García (Frostq)">


  <meta name="twitter:description" content="WebGL y Dart, cómo dibujar figuras simples. Qué son los shaders y como usarlos.">
  <meta name="description" content="WebGL y Dart, cómo dibujar figuras simples. Qué son los shaders y como usarlos.">
  <meta property='og:description' content="WebGL y Dart, cómo dibujar figuras simples. Qué son los shaders y como usarlos." />


<meta name="theme-color" content="#9c95ed">



  
    <meta name="twitter:image:src" content="http://localhost:4000/images/posts/dart2.jpg">
    <meta property='og:image' content="http://localhost:4000/images/posts/dart2.jpg" />
    



  <meta name="twitter:url" content="http://localhost:4000/dart-webgl-figuras-simples">
  <meta property='og:url' content="http://localhost:4000/dart-webgl-figuras-simples" />
 

<script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-87066592-1', 'auto');
    ga('send', 'pageview');
</script>



</head>


<body>

  
  
<nav class="nav_transparent">
    <a href="/en/" class="brand">
      <img class="navbar_logo" src="/images/logo_horizontal.png"  />
      
    </a>
  
    <!-- responsive-->
    <input id="bmenub" type="checkbox" class="show">
    <label for="bmenub" class="burger pseudo button"><i class="fa fa-bars"></i></label>
  
    <div class="menu">
      <ul>
        <a href="/en/blog">
          <li id="header_item">BLOG</li>
        </a>
        <a href="/en/projects">
          <li id="header_item">PROJECTS</li>
        </a>
        <a href="/en/about">
          <li id="header_item">ABOUT ME</li>
        </a>
        <a href="/en/feed.xml">
          <li id="header_item">RSS</li>
        </a>
    
      </ul>
    </div>
  </nav>


<div class="post_header" style="background-image: linear-gradient( rgba(23, 45, 65, 0.5), rgba(54, 75, 94, 0.9) ), url(/images/posts/dart2.jpg)">
  <div class="container post_header_content">
    <h1 class="post_title">WebGL con Dart 02 - Renderizando figuras simples </h1>


    <div class="post_date">January 27, 2017</div>

    <div class="post_tags">
      

      <a class="tags" href="/tag#dart">Dart</a>

      

      <a class="tags" href="/tag#webgl">WebGL</a>

      
    </div>

    

    <div class="post_read_time">
      
        <i class="fa fa-clock-o"></i> 9 min read 
    </div>

  </div>
</div>


<div class="container">


  <div align="center">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- Ad -->
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7551074192374685" data-ad-slot="4480248215" data-ad-format="auto"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>

  <div class="post_content">
    <p>Antes de empezar con este artículo, es recomendable leer el episodio anterior, lo puedes encontrar aqui: <a href="http://frostqui.github.io/tutorial-dart-webgl">http://frostqui.github.io/tutorial-dart-webgl</a>
Bien, entendido este podemos empezar. Este tutorial está basado en los tutoriales de NeHe OpenGL.</p>

<h2>Creando el proyecto</h2>

<p>Lo primero que tenemos que saber es que aunque queramos dibujar renderizar en 2D, no tenemos que olvidar que WebGL dibuja los objetos en un espacio 3D.</p>

<p>Como en el anterior tutorial, empezamos creando el proyecto dart con nuestro IDE, en mi caso con WebStorm. Abrimos el achivo <b>index.html</b> y añadimos el canvas donde dibujaremos
las figuras.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content=</span><span class="s">"IE=edge"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"scaffolded-by"</span> <span class="na">content=</span><span class="s">"https://github.com/google/stagehand"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>untitled<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"styles.css"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;script </span><span class="na">defer</span> <span class="na">src=</span><span class="s">"main.dart"</span> <span class="na">type=</span><span class="s">"application/dart"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">defer</span> <span class="na">src=</span><span class="s">"packages/browser/dart.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>

    <span class="nt">&lt;canvas</span> <span class="na">id=</span><span class="s">"game"</span> <span class="na">width=</span><span class="s">"900px"</span> <span class="na">height=</span><span class="s">"500px"</span><span class="nt">&gt;&lt;/canvas&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>Tras esto, abrimos el archivo <b>main.dart</b>, inicializamos importamos webgl y lo incializamos con el canvas. Además, he importado la librería para tener datos tipados,
y la librería para crear vectores.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="s1">'dart:html'</span> <span class="k">as</span> <span class="nx">html</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">'dart:web_gl'</span> <span class="k">as</span> <span class="nx">GL</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">'dart:typed_data'</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">'package:vector_math/vector_math.dart'</span><span class="p">;</span>

<span class="k">void</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nx">html</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">"#game"</span><span class="p">);</span>

  <span class="nx">gl</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"webgl"</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">gl</span> <span class="o">==</span> <span class="kc">null</span><span class="p">){</span>
    <span class="nx">gl</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"experimental-webgl"</span><span class="p">);</span>
    <span class="nx">_initShaders</span><span class="p">();</span>
    <span class="nx">_initBuffers</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="k">if</span><span class="p">(</span><span class="nx">gl</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">){</span>
    <span class="nx">start</span><span class="p">();</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="nx">html</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="s2">"Tu navegador no soporta WebGL"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nx">start</span><span class="p">(){</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">clearColor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">DEPTH_TEST</span><span class="p">);</span>

<span class="p">}</span>
</code></pre></div></div>

<p>Para importar la librería de los vectores tienes que añadir esto en tu archivo <b>pubspec.yaml</b> y ejecutar el comando <b>pub get</b></p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">dependencies</span><span class="pi">:</span>
  <span class="na">vector_math</span><span class="pi">:</span> <span class="s">any</span>
</code></pre></div></div>

<h2>Creando los buffers</h2>

<p>Ahora vamos a escribir nuestra función para crear los buffers que sean necesarios. Vamos a utilizar los buffers para almacenar las figuras que tienen que ser dibujadas. Para
ello declaramos dos variables de tipo buffers</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">GL</span><span class="p">.</span><span class="nx">Buffer</span> <span class="nx">_triangleVertexPositionBuffer</span><span class="p">;</span>
<span class="nx">GL</span><span class="p">.</span><span class="nx">Buffer</span> <span class="nx">_squareVertexPositionBuffer</span><span class="p">;</span>
</code></pre></div></div>

<p>Toca crear la funcion para inicializar los buffers. Para el triángulo, vamos a almacenar la posición de sus vertices, de esta forma, si hace falta que se vuelva a renderizar,
será más eficiente porque ya tiene su posición. Hacemos lo mismo para el cuadrado.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nx">_initBuffers</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// variable to store verticies</span>
  <span class="nx">List</span><span class="o">&lt;</span><span class="kr">double</span><span class="o">&gt;</span> <span class="nx">vertices</span><span class="p">;</span>

  <span class="c1">// Creamos el triangulo</span>
  <span class="nx">_triangleVertexPositionBuffer</span> <span class="o">=</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">createBuffer</span><span class="p">();</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span> <span class="nx">_triangleVertexPositionBuffer</span><span class="p">);</span>

  <span class="c1">// Rellenamos el buffer con los vértices</span>
  <span class="nx">vertices</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span>
  <span class="p">];</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">bufferDataTyped</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Float32List</span><span class="p">.</span><span class="nx">fromList</span><span class="p">(</span><span class="nx">vertices</span><span class="p">),</span> <span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">STATIC_DRAW</span><span class="p">);</span>

  <span class="c1">// Creamos el cuadrado</span>
  <span class="nx">_squareVertexPositionBuffer</span> <span class="o">=</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">createBuffer</span><span class="p">();</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span> <span class="nx">_squareVertexPositionBuffer</span><span class="p">);</span>

  <span class="c1">// Rellenamos el buffer con los vértices</span>
  <span class="nx">vertices</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span>
  <span class="p">];</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">bufferDataTyped</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Float32List</span><span class="p">.</span><span class="nx">fromList</span><span class="p">(</span><span class="nx">vertices</span><span class="p">),</span> <span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">STATIC_DRAW</span><span class="p">);</span>

<span class="p">}</span>
</code></pre></div></div>

<h2>Dibujando las figuras</h2>

<p>Ahora, vamos a definir la función que dibujará la escena. Lo primero, es usar la funcion <b>clear</b> de WebGl para limpiar el área que vamos a dibujar.
Para nuestra escena vamos a necesitar una Matriz para almacenar las posiciones y las transformaciones, así que creamos una llamada <b>_mvMatrix</b>, y le aplicamos una transformación
para movernos al centro de la escena. El siguiente paso es dibujar las figuras que hay en el buffer. Por último, una vez dibujada cada figura, llamamos al método <b>_setMatrixUniforms()</b>
para que se almacene en la tarjeta gráfica el modelo de la vista.
La función quedaría de la siguiente manera:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">render</span><span class="p">([</span><span class="kr">double</span> <span class="nx">time</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">])</span> <span class="p">{</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">clear</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">COLOR_BUFFER_BIT</span> <span class="o">|</span> <span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">DEPTH_BUFFER_BIT</span><span class="p">);</span>

  <span class="nx">_mvMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Matrix4</span><span class="p">.</span><span class="nx">identity</span><span class="p">();</span>
  <span class="nx">_mvMatrix</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="k">new</span> <span class="nx">Vector3</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.0</span><span class="p">));</span>

  <span class="c1">// Dibujamos el triángulo</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span> <span class="nx">_triangleVertexPositionBuffer</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">vertexAttribPointer</span><span class="p">(</span><span class="nx">_aVertexPosition</span><span class="p">,</span> <span class="nx">_dimensions</span><span class="p">,</span> <span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="nx">_setMatrixUniforms</span><span class="p">();</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">drawArrays</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">TRIANGLES</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">// Triángulo. Empieza en 0. 3 en total</span>

  <span class="c1">// Dibujamos el cuadrado</span>
  <span class="nx">_mvMatrix</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="k">new</span> <span class="nx">Vector3</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">));</span>

  <span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span> <span class="nx">_squareVertexPositionBuffer</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">vertexAttribPointer</span><span class="p">(</span><span class="nx">_aVertexPosition</span><span class="p">,</span> <span class="nx">_dimensions</span><span class="p">,</span> <span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="nx">_setMatrixUniforms</span><span class="p">();</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">drawArrays</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">TRIANGLE_STRIP</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="c1">// Cuadrado. Empieza en 0. 4 en total</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nx">_setMatrixUniforms</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">Float32List</span> <span class="nx">tmpList</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Float32List</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>

  <span class="nx">_pMatrix</span><span class="p">.</span><span class="nx">copyIntoArray</span><span class="p">(</span><span class="nx">tmpList</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">uniformMatrix4fv</span><span class="p">(</span><span class="nx">_uPMatrix</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">tmpList</span><span class="p">);</span>

  <span class="nx">_mvMatrix</span><span class="p">.</span><span class="nx">copyIntoArray</span><span class="p">(</span><span class="nx">tmpList</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">uniformMatrix4fv</span><span class="p">(</span><span class="nx">_uMVMatrix</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">tmpList</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div>

<h2>Creación de los shaders</h2>

<p>Antes de crear los shaders vamos a entender qué son. Los shader son una forma de añadir color e iluminación mediante código a figuras o píxeles. Esto se calcula atomáticamente antes 
de dibujar las figuras. Estos shaders también permiten otros efectos como animaciones, distorisiones o desenfoques. Los shaders también son útiles para hacer los cálculos necesarios 
con la velocidad de la GPU.</p>

<p>Lo primero que hacemos es inicializar un par de Strings. Uno lo usaremos para definir la animación y el otro para definir el color. Lo siguiente que hacemos es compilar los shaders y 
aplicarlos a la escena. Por último comprobamos que el proceso ha salido bien.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nx">_initShaders</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// VertexShader para la creación de la animación</span>

  <span class="nb">String</span> <span class="nx">vsSource</span> <span class="o">=</span> <span class="s2">"""
    attribute vec3 aVertexPosition;
    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;
    void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
    }
    """</span><span class="p">;</span>

  <span class="c1">// Fragment shader para la creación de la animacion de los colores</span>


  <span class="nb">String</span> <span class="nx">fsSource</span> <span class="o">=</span> <span class="s2">"""
    precision mediump float;
    void main(void) {
        gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0);
    }
    """</span><span class="p">;</span>

  <span class="c1">// Compilacion de los dos shaders</span>
  <span class="nx">_vs</span> <span class="o">=</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">createShader</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">VERTEX_SHADER</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">shaderSource</span><span class="p">(</span><span class="nx">_vs</span><span class="p">,</span> <span class="nx">vsSource</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">compileShader</span><span class="p">(</span><span class="nx">_vs</span><span class="p">);</span>

  
  <span class="nx">_fs</span> <span class="o">=</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">createShader</span><span class="p">(</span><span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">FRAGMENT_SHADER</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">shaderSource</span><span class="p">(</span><span class="nx">_fs</span><span class="p">,</span> <span class="nx">fsSource</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">compileShader</span><span class="p">(</span><span class="nx">_fs</span><span class="p">);</span>

  <span class="c1">// Metiendo los shaders en el programa</span>
  <span class="nx">_shaderProgram</span> <span class="o">=</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">createProgram</span><span class="p">();</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">attachShader</span><span class="p">(</span><span class="nx">_shaderProgram</span><span class="p">,</span> <span class="nx">_vs</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">attachShader</span><span class="p">(</span><span class="nx">_shaderProgram</span><span class="p">,</span> <span class="nx">_fs</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">linkProgram</span><span class="p">(</span><span class="nx">_shaderProgram</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">useProgram</span><span class="p">(</span><span class="nx">_shaderProgram</span><span class="p">);</span>

  <span class="c1">//Comprobamos que los shaders han sido añadidos correctamente</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getShaderParameter</span><span class="p">(</span><span class="nx">_vs</span><span class="p">,</span> <span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">COMPILE_STATUS</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getShaderInfoLog</span><span class="p">(</span><span class="nx">_vs</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getShaderParameter</span><span class="p">(</span><span class="nx">_fs</span><span class="p">,</span> <span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">COMPILE_STATUS</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getShaderInfoLog</span><span class="p">(</span><span class="nx">_fs</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getProgramParameter</span><span class="p">(</span><span class="nx">_shaderProgram</span><span class="p">,</span> <span class="nx">GL</span><span class="p">.</span><span class="nx">RenderingContext</span><span class="p">.</span><span class="nx">LINK_STATUS</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">getProgramInfoLog</span><span class="p">(</span><span class="nx">_shaderProgram</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="nx">_aVertexPosition</span> <span class="o">=</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">getAttribLocation</span><span class="p">(</span><span class="nx">_shaderProgram</span><span class="p">,</span> <span class="s2">"aVertexPosition"</span><span class="p">);</span>
  <span class="nx">gl</span><span class="p">.</span><span class="nx">enableVertexAttribArray</span><span class="p">(</span><span class="nx">_aVertexPosition</span><span class="p">);</span>

  <span class="nx">_uPMatrix</span> <span class="o">=</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">getUniformLocation</span><span class="p">(</span><span class="nx">_shaderProgram</span><span class="p">,</span> <span class="s2">"uPMatrix"</span><span class="p">);</span>
  <span class="nx">_uMVMatrix</span> <span class="o">=</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">getUniformLocation</span><span class="p">(</span><span class="nx">_shaderProgram</span><span class="p">,</span> <span class="s2">"uMVMatrix"</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div>
<p>Si todo ha salido bien, al ejecutar nuestro código nos encontraremos con las dos figuras</p>

<p><img src="http://i.imgur.com/ipv3rUu.png" class="responsive-img" alt="tutorial dart webgl" /></p>

<p>El código de todo el archivo <b>main.dart</b> lo puedes encontrar en este github:</p>

<p><a href="https://github.com/martinsik/dart-webgl-tutorials/blob/master/lib/lesson-01/lesson-01.dart">https://github.com/martinsik/dart-webgl-tutorials/blob/master/lib/lesson-01/lesson-01.dart</a></p>


  </div>

  
  <div class="related">
    <h2>Posts recomendados</h2>
    <ul class="related_posts">
      
      
      <li>
        <h5>
          <a href="/en/introduccion-instalacion-angular" class="related_post">
            Angular - Introducción e instalación

          </a>
        </h5>
      </li>
     
      
      
      <li>
        <h5>
          <a href="/en/angular-formularios" class="related_post">
            Angular - FormControl y FormGroup para crear formularios reactivos

          </a>
        </h5>
      </li>
     
      
      
      <li>
        <h5>
          <a href="/en/cuantas-tecnologias-web-existen" class="related_post">
            ¿Cuántas tecnologías para el desarollo web existen?

          </a>
        </h5>
      </li>
     
      
      
      <li>
        <h5>
          <a href="/en/optimizar-angular" class="related_post">
            Optimizar aplicaciones Angular 2 para aumentar la velocidad de carga

          </a>
        </h5>
      </li>
     
      
    </ul>
  </div>




</div>



<div align="center">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- Ad -->
  <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7551074192374685" data-ad-slot="4480248215" data-ad-format="auto"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>



  <footer>
    <div class="flex three">
        <div class="full half-1000">

            <div id="mc_embed_signup">
                <form action="https://github.us14.list-manage.com/subscribe/post?u=cd16a671a63cd217caf6b2f3f&amp;id=bb3cc69837" method="post"
                    id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
                    <div id="mc_embed_signup_scroll">
                        <h2>Newsletter <i class="fa fa-envelope icon_footer" aria-hidden="true"></i></h2>
                        <p>Sigue el blog por email. Introduce tu dirección de correo electrónico para que te mande un correo
                            cuando publique un nuevo artículo en este blog</p>

                        <div class="mc-field-group">
                            <label for="mce-EMAIL">Tu email
                                <span class="asterisk">*</span>
                            </label>
                            <input type="email" style="color:black;" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Introducce tu dirección de correo electrónico">
                        </div>
                        <div id="mce-responses" class="clear">
                            <div class="response" id="mce-error-response" style="display:none"></div>
                            <div class="response" id="mce-success-response" style="display:none"></div>
                        </div>
                        <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                        <div style="position: absolute; left: -5000px;" aria-hidden="true">
                            <input type="text" name="b_cd16a671a63cd217caf6b2f3f_bb3cc69837" tabindex="-1" value="">
                        </div>
                        <div class="clear">
                            <input type="submit" value="Suscribirse por email" name="subscribe" id="mc-embedded-subscribe" class="button footer_button">
                        </div>
                    </div>
                </form>
            </div>

            <!--End mc_embed_signup-->

        </div>
        <div class="full sixth-1000">
          
              
                <ul id="footer_menu">
                   
                    <a href="/en/blog">
                        <li><h4>Blog</h4></li>
                    </a>
                    <a href="/en/projects">
                        <li><h4></h>Projects</h4></li>
                    </a>
                    <a href="/en/about">
                        <li><h4>About me<h4></li>
                    </a>
                    <a href="/en/feed.xml">
                        <li><h4>Rss</h4></li>
                    </a>

                </ul>
           
        </div>
        <div class="full third-1000">
            <ul class="footer_posts">
                    

                    
                   
                    

                    
                    <a href="/en/introduccion-instalacion-angular"><li><h4>Angular - Introducción e instalación</h4></li></a>
                    
                    
                    
                   
                    

                    
                    <a href="/en/angular-formularios"><li><h4>Angular - FormControl y FormGroup para crear formularios reactivos</h4></li></a>
                    
                    
                    
                   
                    

                    
                    <a href="/en/cuantas-tecnologias-web-existen"><li><h4>¿Cuántas tecnologías para el desarollo web existen?</h4></li></a>
                    
                    
                    
                   
                    

                    
                    <a href="/en/optimizar-angular"><li><h4>Optimizar aplicaciones Angular 2 para aumentar la velocidad de carga</h4></li></a>
                    
                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    
                   
                    

                    
                    

            </ul>
        </div>





    </div>
</footer>




  <script src="/js/prism.js"></script>
  <script src="/js/index.js"></script>



</body>







</html>
